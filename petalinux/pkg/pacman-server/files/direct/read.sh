PACMAN_UTIL=./pacman_util.py

#DEVEL=0x24302
#$PACMAN_UTIL --write $DEVEL 0xDEADBEEF

# Direct I2C access registers
MODE=0x24110
ENABLE=0x24111
ADDR=0x24112
REG=0x24113
BYTES=0x24114
DIRECT=0x24120

$PACMAN_UTIL --write $MODE 0 --write $ENABLE 1

# TILE 1+2 VDDD MONITOR (I2C ADDRES 0x48 1+2, 0x49 3+4, ..)
# USES A MUX IN COFIGURATION REGISTER:
# 0b0110 0000 = 0x60 -> I TILE 1
# 0b1000 0000 = 0x80 -> V TILE 1
# 0b1010 0000 = 0xA0 -> I TILE 2
# 0b1100 0000 = 0xC0 -> V TILE 2
#   ^^^                 MUX BITS                 
# REGISTERS:
# 0b0000 0110 = 0x06 -> RESET
# 0b0100 0000 = 0x40 -> CONFIGURATION REGISTERS
# 0b0000 1000 = 0x08 -> START CONVERSION
# 0b0010 0100 = 0x24 -> READY REGISTER
# 0b0001 0000 = 0x10 -> READ DATA

# RESET DEVICE:
$PACMAN_UTIL --write $ADDR 0x48 --write $REG 0x06 --write $BYTES 0
$PACMAN_UTIL --write $DIRECT 0


$PACMAN_UTIL --write $REG 0x40 --write $BYTES 1
# SET MUX TO IDDD TILE 1:
#$PACMAN_UTIL --write $DIRECT 0x60 
# SET MUX TO VDDD TILE 1:
$PACMAN_UTIL --write $DIRECT 0x80 
# SET MUX TO IDDD TILE 2:
#$PACMAN_UTIL --write $DIRECT 0xA0 
# SET MUX TO VDDD TILE 2:
#$PACMAN_UTIL --write $DIRECT 0xC0 

# START CONVERSION
$PACMAN_UTIL --write $REG 0x08 --write $BYTES 0
$PACMAN_UTIL --write $DIRECT 0

sleep 1

# READ READY REGISTER
$PACMAN_UTIL --write $REG 0x24 --write $BYTES 0
$PACMAN_UTIL --write $DIRECT 0
$PACMAN_UTIL --write $BYTES 1
$PACMAN_UTIL --read $DIRECT 

# READ CONVERSION RESULT
$PACMAN_UTIL --write $REG 0x10 --write $BYTES 0
$PACMAN_UTIL --write $DIRECT 0
$PACMAN_UTIL --write $BYTES 3
$PACMAN_UTIL --read $DIRECT 

# MULTIPLY RESULT BY 0.000476837 for result in mV

# REQUEST VDDD TILE 2:
#$PACMAN_UTIL --write $REG 0x40 --write $BYTES 1
#$PACMAN_UTIL --write $DIRECT 0xC0 

# TILE 1 VDDA MONITOR
#$PACMAN_UTIL --write $ADDR 0x40 --write $REG 0x02 --write $BYTES 2
#$PACMAN_UTIL --read $DIRECT 

# TILE 2 VDDA MONITOR
#$PACMAN_UTIL --write $ADDR 0x41 --write $REG 0x02 --write $BYTES 2
#$PACMAN_UTIL --read $DIRECT 

# ... 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 

# TILE 1 IDDA MONITOR
#$PACMAN_UTIL --write $ADDR 0x40 --write $REG 0x01 --write $BYTES 2
#$PACMAN_UTIL --read $DIRECT 

# TILE 2 IDDA MONITOR
#$PACMAN_UTIL --write $ADDR 0x40 --write $REG 0x01 --write $BYTES 2
#$PACMAN_UTIL --read $DIRECT 

# ... 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 
